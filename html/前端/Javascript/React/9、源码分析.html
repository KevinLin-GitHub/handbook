<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title>handbook</title>
    <link rel="stylesheet" type="text/css" href="../../../../static/css/main.css">
</head>
<body>
<div class="nav">
    <div class="logo">
        
            <img src="../../../../idoc-logo.svg">
        
    </div>
<ul><li><a href="../../../../index.html">正则完整篇</a></li><li><a href="#"><span></span>前端</a><ul><li><a href="#"><span></span>Javascript</a><ul><li><a href="#"><span></span>React</a><ul><li><a href="../../../../html/前端/Javascript/React/10、react结合redux实战篇.html">10、react结合redux实战篇</a></li><li><a href="../../../../html/前端/Javascript/React/11、React Router 4.html">11、React Router 4</a></li><li><a href="../../../../html/前端/Javascript/React/12、Immutable学习记录.html">12、Immutable学习记录</a></li><li><a href="../../../../html/前端/Javascript/React/1、环境的搭建.html">1、环境的搭建</a></li><li><a href="../../../../html/前端/Javascript/React/2、JSX语法及非DOM操作属性.html">2、JSX语法及非DOM操作属性</a></li><li><a href="../../../../html/前端/Javascript/React/3、组件的生命周期以及属性状态.html">3、组件的生命周期以及属性状态</a></li><li><a href="../../../../html/前端/Javascript/React/4、事件.html">4、事件</a></li><li><a href="../../../../html/前端/Javascript/React/5、组件的协同及（不）可控组件.html">5、组件的协同及（不）可控组件</a></li><li><a href="../../../../html/前端/Javascript/React/6、action、store、reducer分析.html">6、action、store、reducer分析</a></li><li><a href="../../../../html/前端/Javascript/React/7、异步Action及操作.html">7、异步Action及操作</a></li><li><a href="../../../../html/前端/Javascript/React/8、浅析中间件.html">8、浅析中间件</a></li><li class="active"><a href="../../../../html/前端/Javascript/React/9、源码分析.html">9、源码分析</a></li></ul></li><li><a href="#"><span></span>React Native</a><ul><li><a href="../../../../html/前端/Javascript/React Native/React-native Android环境搭建.html">React-native Android环境搭建</a></li></ul></li><li><a href="../../../../html/前端/Javascript/思维导图.html">思维导图</a></li><li><a href="../../../../html/前端/Javascript/正则完整篇.html">正则完整篇</a></li><li><a href="../../../../html/前端/Javascript/正则表达式.html">正则表达式</a></li><li><a href="../../../../html/前端/Javascript/轻量高效的开源JavaScript插件和库.html">轻量高效的开源JavaScript插件和库</a></li></ul></li></ul></li><li><a href="#"><span></span>服务端</a><ul><li><a href="../../../../html/服务端/docker.html">docker</a></li><li><a href="#"><span></span>node</a><ul><li><a href="#"><span></span>框架</a><ul><li><a href="../../../../html/服务端/node/框架/express详细使用.html">express详细使用</a></li><li><a href="../../../../html/服务端/node/框架/koa基本用法.html">koa基本用法</a></li></ul></li></ul></li><li><a href="#"><span></span>shell</a><ul><li><a href="../../../../html/服务端/shell/shell正则.html">shell正则</a></li><li><a href="../../../../html/服务端/shell/shell脚本入门.html">shell脚本入门</a></li></ul></li><li><a href="#"><span></span>数据库</a><ul><li><a href="../../../../html/服务端/数据库/Redis.html">Redis</a></li><li><a href="#"><span></span>mysql</a><ul><li><a href="../../../../html/服务端/数据库/mysql/Mysql入门.html">Mysql入门</a></li><li><a href="../../../../html/服务端/数据库/mysql/awesome-mysql.html">awesome-mysql</a></li><li><a href="#"><span></span>第一章</a><ul><li><a href="../../../../html/服务端/数据库/mysql/第一章/1.1.html">1.1</a></li><li><a href="../../../../html/服务端/数据库/mysql/第一章/1.2.html">1.2</a></li><li><a href="../../../../html/服务端/数据库/mysql/第一章/1.3.html">1.3</a></li><li><a href="../../../../html/服务端/数据库/mysql/第一章/1.4.html">1.4</a></li><li><a href="../../../../html/服务端/数据库/mysql/第一章/1.html">1</a></li></ul></li><li><a href="#"><span></span>第三章</a><ul><li><a href="../../../../html/服务端/数据库/mysql/第三章/3.1.html">3.1</a></li><li><a href="../../../../html/服务端/数据库/mysql/第三章/3.2.html">3.2</a></li><li><a href="../../../../html/服务端/数据库/mysql/第三章/3.3.html">3.3</a></li><li><a href="../../../../html/服务端/数据库/mysql/第三章/3.4.html">3.4</a></li><li><a href="../../../../html/服务端/数据库/mysql/第三章/3.5.html">3.5</a></li><li><a href="../../../../html/服务端/数据库/mysql/第三章/3.html">3</a></li></ul></li><li><a href="#"><span></span>第二章</a><ul><li><a href="../../../../html/服务端/数据库/mysql/第二章/2.1.html">2.1</a></li><li><a href="../../../../html/服务端/数据库/mysql/第二章/2.2.html">2.2</a></li><li><a href="../../../../html/服务端/数据库/mysql/第二章/2.3.html">2.3</a></li><li><a href="../../../../html/服务端/数据库/mysql/第二章/2.4.html">2.4</a></li><li><a href="../../../../html/服务端/数据库/mysql/第二章/2.5.html">2.5</a></li></ul></li><li><a href="#"><span></span>第四章</a><ul><li><a href="../../../../html/服务端/数据库/mysql/第四章/4.1.html">4.1</a></li><li><a href="../../../../html/服务端/数据库/mysql/第四章/4.2.html">4.2</a></li><li><a href="../../../../html/服务端/数据库/mysql/第四章/4.3.html">4.3</a></li></ul></li></ul></li></ul></li><li><a href="../../../../html/服务端/Nginx.html">Nginx</a></li><li><a href="#"><span></span>centos</a><ul><li><a href="../../../../html/服务端/centos/CentOS7安装KVM虚拟机详解.html">CentOS7安装KVM虚拟机详解</a></li><li><a href="../../../../html/服务端/centos/CentOS7安装维护Gitlab.html">CentOS7安装维护Gitlab</a></li><li><a href="../../../../html/服务端/centos/CentOS7安装配置vsftp搭建FTP.html">CentOS7安装配置vsftp搭建FTP</a></li><li><a href="../../../../html/服务端/centos/CentOS7更换yum软件镜像源.html">CentOS7更换yum软件镜像源</a></li><li><a href="../../../../html/服务端/centos/CentOS7网络配置.html">CentOS7网络配置</a></li><li><a href="../../../../html/服务端/centos/Centos7安装编译Node.html">Centos7安装编译Node</a></li><li><a href="../../../../html/服务端/centos/Centos常用命令.html">Centos常用命令</a></li><li><a href="../../../../html/服务端/centos/Elasticsearch安装维护.html">Elasticsearch安装维护</a></li><li><a href="../../../../html/服务端/centos/Golang安装.html">Golang安装</a></li><li><a href="../../../../html/服务端/centos/Linux添加、删除用户和用户组.html">Linux添加、删除用户和用户组</a></li><li><a href="../../../../html/服务端/centos/Mac下制作CentOS7启动盘.html">Mac下制作CentOS7启动盘</a></li><li><a href="../../../../html/服务端/centos/Mac使用NFS连接CentOS上的共享文件夹.html">Mac使用NFS连接CentOS上的共享文件夹</a></li><li><a href="../../../../html/服务端/centos/Nginx 安装.html">Nginx 安装</a></li><li><a href="../../../../html/服务端/centos/Python2升级到Python3.html">Python2升级到Python3</a></li><li><a href="../../../../html/服务端/centos/Rocket.Chat.html">Rocket.Chat</a></li><li><a href="../../../../html/服务端/centos/Ruby安装.html">Ruby安装</a></li><li><a href="../../../../html/服务端/centos/chmod.html">chmod</a></li><li><a href="../../../../html/服务端/centos/samba.html">samba</a></li><li><a href="../../../../html/服务端/centos/使用免费SSL证书让网站支持HTTPS访问.html">使用免费SSL证书让网站支持HTTPS访问</a></li><li><a href="../../../../html/服务端/centos/修改ssh端口号的方法.html">修改ssh端口号的方法</a></li><li><a href="../../../../html/服务端/centos/在5分钟内搭建企业内部私有npm仓库.html">在5分钟内搭建企业内部私有npm仓库</a></li><li><a href="../../../../html/服务端/centos/安装Java.html">安装Java</a></li><li><a href="../../../../html/服务端/centos/安装openstack.html">安装openstack</a></li><li><a href="../../../../html/服务端/centos/安装pip工具.html">安装pip工具</a></li><li><a href="../../../../html/服务端/centos/安装使用svn.html">安装使用svn</a></li><li><a href="../../../../html/服务端/centos/尝试在CentOS7.2上编译安装Swift.html">尝试在CentOS7.2上编译安装Swift</a></li><li><a href="../../../../html/服务端/centos/常用基础命令.html">常用基础命令</a></li><li><a href="../../../../html/服务端/centos/搭建Shadowsocks服务器.html">搭建Shadowsocks服务器</a></li><li><a href="../../../../html/服务端/centos/管理远程会话screen工具.html">管理远程会话screen工具</a></li><li><a href="../../../../html/服务端/centos/部署Seafile搭建自己的网盘.html">部署Seafile搭建自己的网盘</a></li></ul></li></ul></li><li><a href="#"><span></span>工具箱</a><ul><li><a href="../../../../html/工具箱/Git常用命令.html">Git常用命令</a></li><li><a href="../../../../html/工具箱/vim.html">vim</a></li><li><a href="#"><span></span>代码片段</a><ul><li><a href="../../../../html/工具箱/代码片段/100个JavaScript代码片段.html">100个JavaScript代码片段</a></li></ul></li><li><a href="#"><span></span>服务构建</a><ul><li><a href="../../../../html/工具箱/服务构建/持续集成服务 Travis CI.html">持续集成服务 Travis CI</a></li></ul></li></ul></li><li><a href="#"><span></span>其他</a><ul><li><a href="../../../../html/其他/HTTP状态码.html">HTTP状态码</a></li><li><a href="../../../../html/其他/通过代理工具提高Github Clone速度.html">通过代理工具提高Github Clone速度</a></li></ul></li><li><a href="../../../../html/收藏夹.html">收藏夹</a></li></ul></div>


<div class="forkgithub"><a target="_blank" href="https://github.com/poetries/handbook"></a></div>

<div class="warpper">

    <div class="page-toc">
        <ul><li><a href="#t0一、index.js">一、index.js</a></li><li><a href="#t1二、createStore.js">二、createStore.js</a></li><li><a href="#t2三、combineReducers.js">三、combineReducers.js</a></li><li><a href="#t3四、bindActionCreator.js">四、bindActionCreator.js</a></li><li><a href="#t4五、applyMiddleware.js">五、applyMiddleware.js</a></li></ul>
    </div>
    
    <div class="content markdown-body">
        <h2 id="t0&#x4E00;&#x3001;index.js">&#x4E00;&#x3001;index.js <a href="#t0&#x4E00;&#x3001;index.js"> # </a></h2>
<blockquote>
<p><a href="https://github.com/reactjs/redux/blob/master/src/index.js">https://github.com/reactjs/redux/blob/master/src/index.js</a></p>
</blockquote>
<ul>
<li>&#x66B4;&#x9732;&#x4E86;&#x51E0;&#x4E2A;&#x6838;&#x5FC3;<code>API</code></li>
</ul>
<pre><code class="lang-javascript"><span class="hljs-keyword">import</span> createStore <span class="hljs-keyword">from</span> <span class="hljs-string">&apos;./createStore&apos;</span>;
<span class="hljs-keyword">import</span> combineReducers <span class="hljs-keyword">from</span> <span class="hljs-string">&apos;./utils/combineReducers&apos;</span>;
<span class="hljs-keyword">import</span> bindActionCreators <span class="hljs-keyword">from</span> <span class="hljs-string">&apos;./utils/bindActionCreators&apos;</span>;
<span class="hljs-keyword">import</span> applyMiddleware <span class="hljs-keyword">from</span> <span class="hljs-string">&apos;./utils/applyMiddleware&apos;</span>;
<span class="hljs-keyword">import</span> compose <span class="hljs-keyword">from</span> <span class="hljs-string">&apos;./utils/compose&apos;</span>;

<span class="hljs-keyword">export</span> {
  createStore,
  combineReducers,
  bindActionCreators,
  applyMiddleware,
  compose
};
</code></pre>
<h2 id="t1&#x4E8C;&#x3001;createStore.js">&#x4E8C;&#x3001;createStore.js <a href="#t1&#x4E8C;&#x3001;createStore.js"> # </a></h2>
<blockquote>
<p><a href="https://github.com/reactjs/redux/blob/master/src/createStore.js">https://github.com/reactjs/redux/blob/master/src/createStore.js</a></p>
</blockquote>
<ul>
<li><code>redux.createStore(reducer, initialState)</code> &#x4F20;&#x5165;&#x4E86;<code>reducer</code>&#x3001;<code>initialState</code>&#xFF0C;&#x5E76;&#x8FD4;&#x56DE;&#x4E00;&#x4E2A;<code>store</code>&#x5BF9;&#x8C61;</li>
<li><code>store</code>&#x5BF9;&#x8C61;&#x5BF9;&#x5916;&#x66B4;&#x9732;&#x4E86;<code>dispatch</code>&#x3001;<code>getStat</code>e&#x3001;<code>subscribe</code>&#x65B9;&#x6CD5;</li>
<li><code>store</code>&#x5BF9;&#x8C61;&#x901A;&#x8FC7;<code>getState()</code> &#x83B7;&#x53D6;&#x5185;&#x90E8;&#x72B6;&#x6001;</li>
<li><code>initialState</code>&#x4E3A; <code>store</code> &#x7684;&#x521D;&#x59CB;&#x72B6;&#x6001;&#xFF0C;&#x5982;&#x679C;&#x4E0D;&#x4F20;&#x5219;&#x4E3A;undefined</li>
<li><code>store</code>&#x5BF9;&#x8C61;&#x901A;&#x8FC7;<code>reducer</code>&#x6765;&#x4FEE;&#x6539;&#x5185;&#x90E8;&#x72B6;&#x6001;</li>
<li><code>store</code>&#x5BF9;&#x8C61;&#x521B;&#x5EFA;&#x7684;&#x65F6;&#x5019;&#xFF0C;&#x5185;&#x90E8;&#x4F1A;&#x4E3B;&#x52A8;&#x8C03;&#x7528;<code>dispatch({ type: ActionTypes.INIT })</code>;&#x6765;&#x5BF9;&#x5185;&#x90E8;&#x72B6;&#x6001;&#x8FDB;&#x884C;&#x521D;&#x59CB;&#x5316;&#x3002;&#x901A;&#x8FC7;&#x65AD;&#x70B9;&#x6216;&#x8005;&#x65E5;&#x5FD7;&#x6253;&#x5370;&#x5C31;&#x53EF;&#x4EE5;&#x770B;&#x5230;&#xFF0C;<code>store</code>&#x5BF9;&#x8C61;&#x521B;&#x5EFA;&#x7684;&#x540C;&#x65F6;&#xFF0C;<code>reducer</code>&#x5C31;&#x4F1A;&#x88AB;&#x8C03;&#x7528;&#x8FDB;&#x884C;&#x521D;&#x59CB;&#x5316;</li>
</ul>
<pre><code class="lang-javascript"><span class="hljs-keyword">import</span> isPlainObject <span class="hljs-keyword">from</span> <span class="hljs-string">&apos;./utils/isPlainObject&apos;</span>;

<span class="hljs-comment">/**
 * These are private action types reserved by Redux.
 * For any unknown actions, you must return the current state.
 * If the current state is undefined, you must return the initial state.
 * Do not reference these action types directly in your code.
 */</span>
<span class="hljs-comment">// &#x521D;&#x59CB;&#x5316;&#x7684;&#x65F6;&#x5019;(redux.createStore(reducer, initialState)&#x65F6;),&#x4F20;&#x7684;action.type &#x5C31;&#x662F;&#x8FD9;&#x8D27;&#x5566;</span>
<span class="hljs-keyword">export</span> <span class="hljs-keyword">var</span> ActionTypes = {
  <span class="hljs-attr">INIT</span>: <span class="hljs-string">&apos;@@redux/INIT&apos;</span>
};

<span class="hljs-comment">/**
 * Creates a Redux store that holds the state tree.
 * The only way to change the data in the store is to call `dispatch()` on it.
 *
 * There should only be a single store in your app. To specify how different
 * parts of the state tree respond to actions, you may combine several reducers
 * into a single reducer function by using `combineReducers`.
 *
 * @param {Function} reducer A function that returns the next state tree, given
 * the current state tree and the action to handle.
 *
 * @param {any} [initialState] The initial state. You may optionally specify it
 * to hydrate the state from the server in universal apps, or to restore a
 * previously serialized user session.
 * If you use `combineReducers` to produce the root reducer function, this must be
 * an object with the same shape as `combineReducers` keys.
 *
 * @returns {Store} A Redux store that lets you read the state, dispatch actions
 * and subscribe to changes.
 */</span>
<span class="hljs-keyword">export</span> <span class="hljs-keyword">default</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">createStore</span>(<span class="hljs-params">reducer, initialState</span>) </span>{
  <span class="hljs-keyword">if</span> (<span class="hljs-keyword">typeof</span> reducer !== <span class="hljs-string">&apos;function&apos;</span>) {
    <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> <span class="hljs-built_in">Error</span>(<span class="hljs-string">&apos;Expected the reducer to be a function.&apos;</span>);
  }

  <span class="hljs-keyword">var</span> currentReducer = reducer;
  <span class="hljs-keyword">var</span> currentState = initialState;
  <span class="hljs-keyword">var</span> listeners = [];
  <span class="hljs-keyword">var</span> isDispatching = <span class="hljs-literal">false</span>;

  <span class="hljs-comment">/**
   * Reads the state tree managed by the store.
   *
   * @returns {any} The current state tree of your application.
   */</span>
  <span class="hljs-comment">// &#x8FD9;&#x4E2A;&#x65B9;&#x6CD5;&#x6CA1;&#x4EC0;&#x4E48;&#x597D;&#x8BB2;&#x7684;,&#x8FD4;&#x56DE;&#x5F53;&#x524D;&#x7684;state</span>
  <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">getState</span>(<span class="hljs-params"></span>) </span>{
    <span class="hljs-keyword">return</span> currentState;
  }

  <span class="hljs-comment">/**
   * Adds a change listener. It will be called any time an action is dispatched,
   * and some part of the state tree may potentially have changed. You may then
   * call `getState()` to read the current state tree inside the callback.
   *
   * @param {Function} listener A callback to be invoked on every dispatch.
   * @returns {Function} A function to remove this change listener.
   */</span>
  <span class="hljs-comment">// &#x5F88;&#x5E38;&#x89C1;&#x7684;&#x76D1;&#x542C;&#x51FD;&#x6570;&#x6DFB;&#x52A0;&#x65B9;&#x5F0F;,&#x5F53;store.dispatch &#x7684;&#x65F6;&#x5019;&#x88AB;&#x8C03;&#x7528;</span>
  <span class="hljs-comment">// store.subscribe(listener) &#x8FD4;&#x56DE;&#x4E00;&#x4E2A;&#x65B9;&#x6CD5;(unscribe),&#x53EF;&#x4EE5;&#x7528;&#x6765;&#x53D6;&#x6D88;&#x76D1;&#x542C;</span>
  <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">subscribe</span>(<span class="hljs-params">listener</span>) </span>{
    listeners.push(listener);
    <span class="hljs-keyword">var</span> isSubscribed = <span class="hljs-literal">true</span>;

    <span class="hljs-keyword">return</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">unsubscribe</span>(<span class="hljs-params"></span>) </span>{
      <span class="hljs-keyword">if</span> (!isSubscribed) {
        <span class="hljs-keyword">return</span>;
      }

      isSubscribed = <span class="hljs-literal">false</span>;
      <span class="hljs-keyword">var</span> index = listeners.indexOf(listener);
      listeners.splice(index, <span class="hljs-number">1</span>);
    };
  }

  <span class="hljs-comment">/**
   * Dispatches an action. It is the only way to trigger a state change.
   *
   * The `reducer` function, used to create the store, will be called with the
   * current state tree and the given `action`. Its return value will
   * be considered the **next** state of the tree, and the change listeners
   * will be notified.
   *
   * The base implementation only supports plain object actions. If you want to
   * dispatch a Promise, an Observable, a thunk, or something else, you need to
   * wrap your store creating function into the corresponding middleware. For
   * example, see the documentation for the `redux-thunk` package. Even the
   * middleware will eventually dispatch plain object actions using this method.
   *
   * @param {Object} action A plain object representing &#x201C;what changed&#x201D;. It is
   * a good idea to keep actions serializable so you can record and replay user
   * sessions, or use the time travelling `redux-devtools`. An action must have
   * a `type` property which may not be `undefined`. It is a good idea to use
   * string constants for action types.
   *
   * @returns {Object} For convenience, the same action object you dispatched.
   *
   * Note that, if you use a custom middleware, it may wrap `dispatch()` to
   * return something else (for example, a Promise you can await).
   */</span>
  <span class="hljs-comment">// &#x4EE5;&#x4E0B;&#x60C5;&#x51B5;&#x4F1A;&#x62A5;&#x9519;</span>
  <span class="hljs-comment">// 1. &#x4F20;&#x5165;&#x7684;action&#x4E0D;&#x662F;&#x4E00;&#x4E2A;&#x5BF9;&#x8C61;</span>
  <span class="hljs-comment">// 2. &#x4F20;&#x5165;&#x7684;action&#x662F;&#x4E2A;&#x5BF9;&#x8C61;,&#x4F46;&#x662F;action.type &#x662F;undefined</span>
  <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">dispatch</span>(<span class="hljs-params">action</span>) </span>{
    <span class="hljs-keyword">if</span> (!isPlainObject(action)) {
      <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> <span class="hljs-built_in">Error</span>(
        <span class="hljs-string">&apos;Actions must be plain objects. &apos;</span> +
        <span class="hljs-string">&apos;Use custom middleware for async actions.&apos;</span>
      );
    }

    <span class="hljs-keyword">if</span> (<span class="hljs-keyword">typeof</span> action.type === <span class="hljs-string">&apos;undefined&apos;</span>) {
      <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> <span class="hljs-built_in">Error</span>(
        <span class="hljs-string">&apos;Actions may not have an undefined &quot;type&quot; property. &apos;</span> +
        <span class="hljs-string">&apos;Have you misspelled a constant?&apos;</span>
      );
    }

    <span class="hljs-keyword">if</span> (isDispatching) {
      <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> <span class="hljs-built_in">Error</span>(<span class="hljs-string">&apos;Reducers may not dispatch actions.&apos;</span>);
    }

    <span class="hljs-keyword">try</span> {
      isDispatching = <span class="hljs-literal">true</span>;
      <span class="hljs-comment">// &#x5C31;&#x662F;&#x8FD9;&#x4E00;&#x53E5;&#x5566;, &#x5C06; currentState &#x8BBE;&#x7F6E;&#x4E3A; reducer(currentState, action) &#x8FD4;&#x56DE;&#x7684;&#x503C;</span>
      currentState = currentReducer(currentState, action);
    } <span class="hljs-keyword">finally</span> {
      isDispatching = <span class="hljs-literal">false</span>;
    }

    <span class="hljs-comment">// &#x5982;&#x679C;&#x6709;&#x76D1;&#x542C;&#x51FD;&#x6570;,&#x5C31;&#x987A;&#x5E8F;&#x8C03;&#x7528;</span>
    listeners.slice().forEach(<span class="hljs-function"><span class="hljs-params">listener</span> =&gt;</span> listener());

    <span class="hljs-comment">// &#x6700;&#x540E;,&#x8FD4;&#x56DE;&#x4F20;&#x5165;&#x7684;action</span>
    <span class="hljs-keyword">return</span> action;
  }

  <span class="hljs-comment">/**
   * Replaces the reducer currently used by the store to calculate the state.
   *
   * You might need this if your app implements code splitting and you want to
   * load some of the reducers dynamically. You might also need this if you
   * implement a hot reloading mechanism for Redux.
   *
   * @param {Function} nextReducer The reducer for the store to use instead.
   * @returns {void}
   */</span>
  <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">replaceReducer</span>(<span class="hljs-params">nextReducer</span>) </span>{
    currentReducer = nextReducer;
    dispatch({ <span class="hljs-attr">type</span>: ActionTypes.INIT });
  }

  <span class="hljs-comment">// When a store is created, an &quot;INIT&quot; action is dispatched so that every</span>
  <span class="hljs-comment">// reducer returns their initial state. This effectively populates</span>
  <span class="hljs-comment">// the initial state tree.</span>
  <span class="hljs-comment">//</span>
  <span class="hljs-comment">// redux.createStore(reducer, initialState) &#x7684;&#x65F6;&#x5019;, &#x5185;&#x90E8;&#x4F1A; &#x81EA;&#x5DF1;&#x8C03;&#x7528; dispatch({ type: ActionTypes.INIT });</span>
  <span class="hljs-comment">// &#x6765;&#x5B8C;&#x6210;state&#x7684;&#x521D;&#x59CB;&#x5316;</span>
  dispatch({ <span class="hljs-attr">type</span>: ActionTypes.INIT });

  <span class="hljs-comment">// &#x8FD4;&#x56DE;&#x7684;&#x5C31;&#x662F;&#x8FD9;&#x4E2A;&#x4E1C;&#x4E1C;&#x4E86;,&#x53EA;&#x6709;&#x56DB;&#x4E2A;&#x65B9;&#x6CD5;</span>
  <span class="hljs-keyword">return</span> {
    dispatch,
    subscribe,
    getState,
    replaceReducer
  };
}
</code></pre>
<h2 id="t2&#x4E09;&#x3001;combineReducers.js">&#x4E09;&#x3001;combineReducers.js <a href="#t2&#x4E09;&#x3001;combineReducers.js"> # </a></h2>
<blockquote>
<p><a href="https://github.com/reactjs/redux/blob/master/src/combineReducers.js">https://github.com/reactjs/redux/blob/master/src/combineReducers.js</a></p>
</blockquote>
<ul>
<li><p><code>redux.combineReducers(reducerMap)</code> &#x7684;&#x4F5C;&#x7528;&#x5728;&#x4E8E;&#x5408;&#x5E76;&#x591A;&#x4E2A;<code>reducer</code>&#x51FD;&#x6570;&#xFF0C;&#x5E76;&#x8FD4;&#x56DE;&#x4E00;&#x4E2A;&#x65B0;&#x7684;<code>reducer</code>&#x51FD;&#x6570;&#x3002;&#x56E0;&#x6B64;&#x53EF;&#x4EE5;&#x770B;&#x5230;&#xFF0C;<code>combineReducers</code> &#x8FD4;&#x56DE;&#x4E86;&#x4E00;&#x4E2A;&#x51FD;&#x6570;&#xFF0C;&#x5E76;&#x4E14;&#x8BE5;&#x51FD;&#x6570;&#x7684;&#x53C2;&#x6570;&#x540C;&#x6837;&#x662F;<code>state</code>&#x3001;<code>reducer</code></p>
</li>
<li><p>&#x6700;&#x7EC8; <code>store.getState()</code>&#x8FD4;&#x56DE;&#x7684;<code>state</code>&#xFF0C;&#x5927;&#x6982;&#x4F1A;&#x662F;&#x8FD9;&#x4E48;&#x4E2A;&#x6837;&#x5B50;<code>{todos: xx, filter: xx}</code>&#x3002;&#x7B80;&#x5355;&#x7684;&#x8BF4;&#xFF0C;<code>state</code>&#x88AB;&#x62C6;&#x5206;&#x6210;&#x4E86;&#x4E24;&#x4EFD;&#xFF0C;<code>TodoReducer</code>&#x7684;&#x8FD4;&#x56DE;&#x503C;&#x8D4B;&#x503C;&#x7ED9;&#x4E86;<code>state.todos</code>&#xFF0C;<code>FilterReducer</code>&#x7684;&#x8FD4;&#x56DE;&#x503C;&#x8D4B;&#x503C;&#x7ED9;&#x4E86;<code>state.filter</code></p>
</li>
</ul>
<pre><code class="lang-javascript"><span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">TodoReducer</span>(<span class="hljs-params">state, action</span>) </span>{}
<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">FilterReducer</span>(<span class="hljs-params">state, action</span>) </span>{}

<span class="hljs-keyword">var</span> finalReducers = redux.combineReducers({
    <span class="hljs-attr">todos</span>: TodoReducer,
    <span class="hljs-attr">filter</span>: FilterReducer
});
</code></pre>
<ul>
<li><code>combineReducers(reducerMap)</code> &#x4F20;&#x5165;&#x4E00;&#x4E2A;&#x5BF9;&#x8C61;&#xFF0C;&#x5E76;&#x8FD4;&#x56DE;&#x4E00;&#x4E2A;&#x5168;&#x65B0;&#x7684;<code>reducer</code>&#x3002;&#x8C03;&#x7528;&#x65B9;&#x5F0F;&#x8DDF;&#x8DDF;&#x666E;&#x901A;&#x7684;<code>reducer</code>&#x4E00;&#x6837;&#xFF0C;&#x4E5F;&#x662F;&#x4F20;&#x5165;<code>state</code>&#x3001;<code>action</code></li>
<li>&#x901A;&#x8FC7;<code>combineReducers</code>&#xFF0C;&#x5BF9; <code>store</code> &#x7684;&#x72B6;&#x6001;<code>state</code>&#x8FDB;&#x884C;&#x62C6;&#x5206;</li>
<li><code>reducerMap&#x7684;key</code>&#xFF0C;&#x5C31;&#x662F; <code>state</code> &#x7684;<code>key</code>&#xFF0C;&#x800C; &#x8C03;&#x7528;&#x5BF9;&#x5E94;&#x7684;<code>reducer</code>&#x8FD4;&#x56DE;&#x7684;&#x503C;&#xFF0C;&#x5219;&#x662F;&#x8FD9;&#x4E2A;<code>key</code>&#x5BF9;&#x5E94;&#x7684;&#x503C;&#x3002;&#x5982;&#x4E0A;&#x9762;&#x7684;&#x4F8B;&#x5B50;&#xFF0C;<code>state.todos == TodoReducer(state, action)</code></li>
<li><code>redux.createStore(finalReducers, initialState)</code> &#x8C03;&#x7528;&#x65F6;&#xFF0C;&#x540C;&#x6837;&#x4F1A;&#x5BF9; <code>state</code>&#x8FDB;&#x884C;&#x521D;&#x59CB;&#x5316;&#x3002;&#x8FD9;&#x4E2A;&#x521D;&#x59CB;&#x5316;&#x8DDF;&#x901A;&#x8FC7;&#x666E;&#x901A;&#x7684;<code>reducer</code>&#x8FDB;&#x884C;&#x521D;&#x59CB;&#x5316;&#x6CA1;&#x591A;&#x5927;&#x533A;&#x522B;&#x3002;&#x4E3E;&#x4F8B;&#x6765;&#x8BF4;&#xFF0C;&#x5982;&#x679C; <code>initialState.todos = undefined</code>&#xFF0C;&#x90A3;&#x4E48; <code>TodoReducer(state, action)</code>&#x521D;&#x59CB;&#x4F20;&#x5165;&#x7684;<code>state</code>&#x5C31;&#x662F;<code>undefined</code>&#xFF1B;&#x5982;&#x679C;<code>initialState.todos = []</code>&#xFF0C;&#x90A3;&#x4E48; <code>TodoReducer(state, action)</code>&#x521D;&#x59CB;&#x4F20;&#x5165;&#x7684;<code>state</code>&#x5C31;&#x662F;<code>[]</code></li>
<li><code>store.dispatch(action)</code>&#xFF0C;<code>finalReducers</code> &#x91CC;&#x9762;&#xFF0C;&#x4F1A;&#x904D;&#x5386;&#x6574;&#x4E2A;<code>reducerMap</code>&#xFF0C;&#x4F9D;&#x6B21;&#x8C03;&#x7528;&#x6BCF;&#x4E2A;<code>reducer</code>&#xFF0C;&#x5E76;&#x5C06;&#x6BCF;&#x4E2A;<code>reducer</code>&#x8FD4;&#x56DE;&#x7684;&#x5B50;<code>state</code>&#x8D4B;&#x7ED9;<code>state</code>&#x5BF9;&#x5E94;&#x7684;<code>key</code>&#x3002;</li>
</ul>
<pre><code class="lang-javascript"><span class="hljs-keyword">import</span> { ActionTypes } <span class="hljs-keyword">from</span> <span class="hljs-string">&apos;../createStore&apos;</span>;
<span class="hljs-keyword">import</span> isPlainObject <span class="hljs-keyword">from</span> <span class="hljs-string">&apos;../utils/isPlainObject&apos;</span>;
<span class="hljs-keyword">import</span> mapValues <span class="hljs-keyword">from</span> <span class="hljs-string">&apos;../utils/mapValues&apos;</span>;
<span class="hljs-keyword">import</span> pick <span class="hljs-keyword">from</span> <span class="hljs-string">&apos;../utils/pick&apos;</span>;

<span class="hljs-comment">/* eslint-disable no-console */</span>

<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">getUndefinedStateErrorMessage</span>(<span class="hljs-params">key, action</span>) </span>{
  <span class="hljs-keyword">var</span> actionType = action &amp;&amp; action.type;
  <span class="hljs-keyword">var</span> actionName = actionType &amp;&amp; <span class="hljs-string">`&quot;<span class="hljs-subst">${actionType.toString()}</span>&quot;`</span> || <span class="hljs-string">&apos;an action&apos;</span>;

  <span class="hljs-keyword">return</span> (
    <span class="hljs-string">`Reducer &quot;<span class="hljs-subst">${key}</span>&quot; returned undefined handling <span class="hljs-subst">${actionName}</span>. `</span> +
    <span class="hljs-string">`To ignore an action, you must explicitly return the previous state.`</span>
  );
}

<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">getUnexpectedStateKeyWarningMessage</span>(<span class="hljs-params">inputState, outputState, action</span>) </span>{
  <span class="hljs-keyword">var</span> reducerKeys = <span class="hljs-built_in">Object</span>.keys(outputState);
  <span class="hljs-keyword">var</span> argumentName = action &amp;&amp; action.type === ActionTypes.INIT ?
    <span class="hljs-string">&apos;initialState argument passed to createStore&apos;</span> :
    <span class="hljs-string">&apos;previous state received by the reducer&apos;</span>;

  <span class="hljs-keyword">if</span> (reducerKeys.length === <span class="hljs-number">0</span>) {
    <span class="hljs-keyword">return</span> (
      <span class="hljs-string">&apos;Store does not have a valid reducer. Make sure the argument passed &apos;</span> +
      <span class="hljs-string">&apos;to combineReducers is an object whose values are reducers.&apos;</span>
    );
  }

  <span class="hljs-keyword">if</span> (!isPlainObject(inputState)) {
    <span class="hljs-keyword">return</span> (
      <span class="hljs-string">`The <span class="hljs-subst">${argumentName}</span> has unexpected type of &quot;`</span> +
      ({}).toString.call(inputState).match(<span class="hljs-regexp">/\s([a-z|A-Z]+)/</span>)[<span class="hljs-number">1</span>] +
      <span class="hljs-string">`&quot;. Expected argument to be an object with the following `</span> +
      <span class="hljs-string">`keys: &quot;<span class="hljs-subst">${reducerKeys.join(<span class="hljs-string">&apos;&quot;, &quot;&apos;</span>)}</span>&quot;`</span>
    );
  }

  <span class="hljs-keyword">var</span> unexpectedKeys = <span class="hljs-built_in">Object</span>.keys(inputState).filter(
    <span class="hljs-function"><span class="hljs-params">key</span> =&gt;</span> reducerKeys.indexOf(key) &lt; <span class="hljs-number">0</span>
  );

  <span class="hljs-keyword">if</span> (unexpectedKeys.length &gt; <span class="hljs-number">0</span>) {
    <span class="hljs-keyword">return</span> (
      <span class="hljs-string">`Unexpected <span class="hljs-subst">${unexpectedKeys.length &gt; <span class="hljs-number">1</span> ? <span class="hljs-string">&apos;keys&apos;</span> : <span class="hljs-string">&apos;key&apos;</span>}</span> `</span> +
      <span class="hljs-string">`&quot;<span class="hljs-subst">${unexpectedKeys.join(<span class="hljs-string">&apos;&quot;, &quot;&apos;</span>)}</span>&quot; found in <span class="hljs-subst">${argumentName}</span>. `</span> +
      <span class="hljs-string">`Expected to find one of the known reducer keys instead: `</span> +
      <span class="hljs-string">`&quot;<span class="hljs-subst">${reducerKeys.join(<span class="hljs-string">&apos;&quot;, &quot;&apos;</span>)}</span>&quot;. Unexpected keys will be ignored.`</span>
    );
  }
}

<span class="hljs-comment">// &#x5BF9;reducer&#x505A;&#x5408;&#x6CD5;&#x6027;&#x68C0;&#x6D4B;</span>
<span class="hljs-comment">// store = Redux.createStore(reducer, initialState) --&gt;</span>
<span class="hljs-comment">// currentState = initialState</span>
<span class="hljs-comment">// currentState = currentReducer(currentState, action);</span>
<span class="hljs-comment">//</span>
<span class="hljs-comment">// &#x4ECE;&#x8C03;&#x7528;&#x5173;&#x7CFB;,&#x8C03;&#x7528;&#x65F6;&#x673A;&#x6765;&#x770B;, store.getState() &#x7684;&#x521D;&#x59CB;&#x503C;(currentState)</span>
<span class="hljs-comment">// &#x4E3A; currentReducer(initialState, { type: ActionTypes.INIT })</span>
<span class="hljs-comment">//</span>
<span class="hljs-comment">// 1. &#x5728;&#x521D;&#x59CB;&#x5316;&#x9636;&#x6BB5;,reducer &#x4F20;&#x5165;&#x7684; state &#x503C;&#x662F; undefined,&#x6B64;&#x65F6;,&#x9700;&#x8981;&#x8FD4;&#x56DE;&#x521D;&#x59CB;state,&#x4E14;&#x521D;&#x59CB;state&#x4E0D;&#x80FD;&#x4E3A;undefined</span>
<span class="hljs-comment">// 2. &#x5F53;&#x4F20;&#x5165;&#x4E0D;&#x8BA4;&#x8BC6;&#x7684; actionType &#x65F6;, reducer(state, {type}) &#x8FD4;&#x56DE;&#x7684;&#x4E0D;&#x80FD;&#x662F;undefined</span>
<span class="hljs-comment">// 3. redux/ &#x8FD9;&#x4E2A; namespace &#x4E0B;&#x7684;action &#x4E0D;&#x5E94;&#x8BE5;&#x505A;&#x5904;&#x7406;,&#x76F4;&#x63A5;&#x8FD4;&#x56DE; currentState &#x5C31;&#x884C; (&#x8C01;&#x8FD0;&#x6C14;&#x8FD9;&#x4E48;&#x5DEE;&#x4F1A;&#x53BB;&#x7528;&#x8FD9;&#x79CD;actionType...)</span>
<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">assertReducerSanity</span>(<span class="hljs-params">reducers</span>) </span>{
  <span class="hljs-built_in">Object</span>.keys(reducers).forEach(<span class="hljs-function"><span class="hljs-params">key</span> =&gt;</span> {
    <span class="hljs-keyword">var</span> reducer = reducers[key];
    <span class="hljs-keyword">var</span> initialState = reducer(<span class="hljs-literal">undefined</span>, { <span class="hljs-attr">type</span>: ActionTypes.INIT });

    <span class="hljs-keyword">if</span> (<span class="hljs-keyword">typeof</span> initialState === <span class="hljs-string">&apos;undefined&apos;</span>) {
      <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> <span class="hljs-built_in">Error</span>(
        <span class="hljs-string">`Reducer &quot;<span class="hljs-subst">${key}</span>&quot; returned undefined during initialization. `</span> +
        <span class="hljs-string">`If the state passed to the reducer is undefined, you must `</span> +
        <span class="hljs-string">`explicitly return the initial state. The initial state may `</span> +
        <span class="hljs-string">`not be undefined.`</span>
      );
    }

    <span class="hljs-keyword">var</span> type = <span class="hljs-string">&apos;@@redux/PROBE_UNKNOWN_ACTION_&apos;</span> + <span class="hljs-built_in">Math</span>.random().toString(<span class="hljs-number">36</span>).substring(<span class="hljs-number">7</span>).split(<span class="hljs-string">&apos;&apos;</span>).join(<span class="hljs-string">&apos;.&apos;</span>);
    <span class="hljs-keyword">if</span> (<span class="hljs-keyword">typeof</span> reducer(<span class="hljs-literal">undefined</span>, { type }) === <span class="hljs-string">&apos;undefined&apos;</span>) {
      <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> <span class="hljs-built_in">Error</span>(
        <span class="hljs-string">`Reducer &quot;<span class="hljs-subst">${key}</span>&quot; returned undefined when probed with a random type. `</span> +
        <span class="hljs-string">`Don&apos;t try to handle <span class="hljs-subst">${ActionTypes.INIT}</span> or other actions in &quot;redux/*&quot; `</span> +
        <span class="hljs-string">`namespace. They are considered private. Instead, you must return the `</span> +
        <span class="hljs-string">`current state for any unknown actions, unless it is undefined, `</span> +
        <span class="hljs-string">`in which case you must return the initial state, regardless of the `</span> +
        <span class="hljs-string">`action type. The initial state may not be undefined.`</span>
      );
    }
  });
}

<span class="hljs-comment">/**
 * Turns an object whose values are different reducer functions, into a single
 * reducer function. It will call every child reducer, and gather their results
 * into a single state object, whose keys correspond to the keys of the passed
 * reducer functions.
 *
 * @param {Object} reducers An object whose values correspond to different
 * reducer functions that need to be combined into one. One handy way to obtain
 * it is to use ES6 `import * as reducers` syntax. The reducers may never return
 * undefined for any action. Instead, they should return their initial state
 * if the state passed to them was undefined, and the current state for any
 * unrecognized action.
 *
 * @returns {Function} A reducer function that invokes every reducer inside the
 * passed object, and builds a state object with the same shape.
 */</span>

<span class="hljs-keyword">export</span> <span class="hljs-keyword">default</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">combineReducers</span>(<span class="hljs-params">reducers</span>) </span>{
  <span class="hljs-comment">// &#x8FD4;&#x56DE;&#x4E00;&#x4E2A;&#x5BF9;&#x8C61;, key =&gt; value &#x4E14;value&#x662F;function(&#x5176;&#x5B9E;&#x5C31;&#x662F;&#x8FC7;&#x6EE4;&#x6389;&#x975E;function)</span>
  <span class="hljs-keyword">var</span> finalReducers = pick(reducers, (val) =&gt; <span class="hljs-keyword">typeof</span> val === <span class="hljs-string">&apos;function&apos;</span>);
  <span class="hljs-keyword">var</span> sanityError;

  <span class="hljs-keyword">try</span> {
    <span class="hljs-comment">// &#x5BF9;&#x6240;&#x6709;&#x7684;&#x5B50;reducer &#x505A;&#x4E00;&#x4E9B;&#x5408;&#x6CD5;&#x6027;&#x65AD;&#x8A00;,&#x5982;&#x679C;&#x6CA1;&#x6709;&#x51FA;&#x9519;&#x518D;&#x7EE7;&#x7EED;&#x4E0B;&#x9762;&#x7684;&#x5904;&#x7406;</span>
    <span class="hljs-comment">// &#x5408;&#x6CD5;&#x6027;&#x65AD;&#x8A00;&#x7684;&#x5185;&#x5BB9;,&#x89C1;API&#x6CE8;&#x91CA;</span>
    assertReducerSanity(finalReducers);
  } <span class="hljs-keyword">catch</span> (e) {
    sanityError = e;
  }

  <span class="hljs-comment">// &#x6240;&#x6709;&#x7684; key: value,&#x5C06;value&#x7F6E;&#x6210;&#x4E86;undefined,&#x8D39;&#x89E3;...</span>
  <span class="hljs-comment">// &#x603B;&#x800C;&#x8A00;&#x4E4B;, &#x521D;&#x59CB;state &#x5C31;&#x662F; &#x7C7B;&#x4F3C; {hello: undefined, world: undefined} &#x7684;&#x4E1C;&#x4E1C;</span>
  <span class="hljs-comment">// TODO &#x786E;&#x8BA4;&#x8FD9;&#x91CC;&#x7684;&#x903B;&#x8F91;</span>
  <span class="hljs-keyword">var</span> defaultState = mapValues(finalReducers, () =&gt; <span class="hljs-literal">undefined</span>);

  <span class="hljs-keyword">return</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">combination</span>(<span class="hljs-params">state = defaultState, action</span>) </span>{
    <span class="hljs-keyword">if</span> (sanityError) {
      <span class="hljs-keyword">throw</span> sanityError;
    }

    <span class="hljs-keyword">var</span> hasChanged = <span class="hljs-literal">false</span>;
    <span class="hljs-comment">// &#x8FD9;&#x6BB5;&#x4EE3;&#x7801;,&#x7B80;&#x5355;&#x7684;&#x8BF4;,&#x5C31;&#x662F;&#x5FAA;&#x73AF;&#x4E00;&#x904D; finalState[key] = fn(reducer, key)</span>
    <span class="hljs-keyword">var</span> finalState = mapValues(finalReducers, (reducer, key) =&gt; {
      <span class="hljs-keyword">var</span> previousStateForKey = state[key];
      <span class="hljs-keyword">var</span> nextStateForKey = reducer(previousStateForKey, action);
      <span class="hljs-keyword">if</span> (<span class="hljs-keyword">typeof</span> nextStateForKey === <span class="hljs-string">&apos;undefined&apos;</span>) {
        <span class="hljs-comment">// &#x5176;&#x4ED6;&#x4E00;&#x4E2A;reducer&#x8FD4;&#x56DE;&#x7684;&#x662F;undefined,&#x4E8E;&#x662F;&#x6302;&#x5566;...&#x629B;&#x51FA;&#x9519;&#x8BEF;</span>
        <span class="hljs-keyword">var</span> errorMessage = getUndefinedStateErrorMessage(key, action);
        <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> <span class="hljs-built_in">Error</span>(errorMessage);
      }
      <span class="hljs-comment">// &#x8FD9;&#x6BB5;&#x4EE3;&#x7801;&#x6709;&#x4E9B;&#x8D39;&#x89E3;,&#x4ECE;redux&#x7684;&#x8BBE;&#x8BA1;&#x7406;&#x5FF5;&#x4E0A;&#x6765;&#x8BB2;,&#x9664;&#x4E86;&#x4E0D;&#x8BA4;&#x8BC6;&#x7684;action type,&#x5176;&#x4ED6;&#x60C5;&#x51B5;&#x90FD;&#x5E94;&#x8BE5;&#x8FD4;&#x56DE;&#x5168;&#x65B0;&#x7684;state</span>
      <span class="hljs-comment">// &#x4E5F;&#x5C31;&#x662F;&#x8BF4;</span>
      <span class="hljs-comment">// 1. action type &#x8BA4;&#x8BC6;,&#x8FD4;&#x56DE;&#x65B0;&#x7684;state,&#x4E8E;&#x662F;&#x8FD9;&#x91CC; hasChanged &#x4E3A; true</span>
      <span class="hljs-comment">// 2. action type &#x4E0D;&#x8BA4;&#x8BC6;,&#x8FD4;&#x56DE;&#x539F;&#x6765;&#x7684;state,&#x4E8E;&#x662F;&#x8FD9;&#x91CC; hasChanged &#x4E3A; false</span>
      <span class="hljs-comment">// 3. &#x4E0D;&#x7BA1;action type &#x662F;&#x5426;&#x8BA4;&#x8BC6;, &#x5728;&#x539F;&#x6765;&#x7684;state&#x4E0A;&#x4FEE;&#x6539;,&#x4F46;&#x662F;&#x8FD4;&#x56DE;&#x7684;&#x662F;&#x4FEE;&#x6539;&#x540E;&#x7684;state(&#x6CA1;&#x6709;&#x8FD4;&#x56DE;&#x62F7;&#x8D1D;),&#x90A3;&#x4E48;,hasChanged&#x8FD8;&#x662F;&#x4E3A;false</span>
      hasChanged = hasChanged || nextStateForKey !== previousStateForKey;
      <span class="hljs-keyword">return</span> nextStateForKey;
    });

    <span class="hljs-comment">// &#x5F00;&#x53D1;&#x73AF;&#x5883;&#x4E2D;(&#x4E8E;&#x662F;&#x8BB0;&#x5F97;&#x5728;&#x751F;&#x4EA7;&#x73AF;&#x5883;&#x53BB;&#x6389;)</span>
    <span class="hljs-comment">// &#x540E;&#x9762;&#x518D;&#x7814;&#x7A76;&#x8FD9;&#x6BB5;&#x4EE3;&#x7801;,&#x6BD5;&#x7ADF;&#x4E0D;&#x662F;&#x4E3B;&#x7EBF;&#x8DEF;...</span>
    <span class="hljs-keyword">if</span> (process.env.NODE_ENV !== <span class="hljs-string">&apos;production&apos;</span>) {
      <span class="hljs-keyword">var</span> warningMessage = getUnexpectedStateKeyWarningMessage(state, finalState, action);
      <span class="hljs-keyword">if</span> (warningMessage) {
        <span class="hljs-built_in">console</span>.error(warningMessage);
      }
    }

    <span class="hljs-keyword">return</span> hasChanged ? finalState : state;
  };
}
</code></pre>
<h2 id="t3&#x56DB;&#x3001;bindActionCreator.js">&#x56DB;&#x3001;bindActionCreator.js <a href="#t3&#x56DB;&#x3001;bindActionCreator.js"> # </a></h2>
<blockquote>
<p><a href="https://github.com/reactjs/redux/blob/master/src/bindActionCreators.js">https://github.com/reactjs/redux/blob/master/src/bindActionCreators.js</a></p>
</blockquote>
<ul>
<li>&#x5148;&#x770B;&#x4E2A;&#x7B80;&#x5355;&#x4F8B;&#x5B50;&#x53EF;&#x80FD;&#x65B9;&#x4FBF;&#x7406;&#x89E3;&#x4E00;&#x4E9B;</li>
</ul>
<pre><code class="lang-javascript"><span class="hljs-keyword">var</span> addTodo = <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">text</span>)</span>{
    <span class="hljs-keyword">return</span> {
        <span class="hljs-attr">type</span>: <span class="hljs-string">&apos;add_todo&apos;</span>,
        <span class="hljs-attr">text</span>: text
    };
};

<span class="hljs-keyword">var</span> addTodos = <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>)</span>{
    <span class="hljs-keyword">return</span> {
        <span class="hljs-attr">type</span>: <span class="hljs-string">&apos;add_todos&apos;</span>,
        <span class="hljs-attr">items</span>: <span class="hljs-built_in">Array</span>.prototype.slice.call(<span class="hljs-built_in">arguments</span>, <span class="hljs-number">0</span>)
    };
};

<span class="hljs-keyword">var</span> reducer = <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">state, action</span>)</span>{
    <span class="hljs-keyword">switch</span> (action.type) {
        <span class="hljs-keyword">case</span> <span class="hljs-string">&apos;add_todo&apos;</span>:
            <span class="hljs-keyword">return</span> state.concat(action.text);
        <span class="hljs-keyword">case</span> <span class="hljs-string">&apos;add_todos&apos;</span>:
            <span class="hljs-keyword">return</span> state.concat(action.items);
        <span class="hljs-keyword">default</span>:
            <span class="hljs-keyword">return</span> state;
    }
};


<span class="hljs-keyword">var</span> store = redux.createStore(reducer, []);
<span class="hljs-comment">// &#x6CE8;&#x610F;,&#x5173;&#x952E;&#x4EE3;&#x7801;&#x5728;&#x8FD9;&#x91CC;</span>
<span class="hljs-keyword">var</span> actions = redux.bindActionCreators({
    <span class="hljs-attr">addTodo</span>: addTodo,
    <span class="hljs-attr">addTodos</span>: addTodos
}, store.dispatch);

<span class="hljs-built_in">console</span>.log(<span class="hljs-string">&apos;state is: &apos;</span> + store.getState());

store.dispatch({<span class="hljs-attr">type</span>: <span class="hljs-string">&apos;add_todo&apos;</span>, <span class="hljs-attr">text</span>: <span class="hljs-string">&apos;&#x8BFB;&#x4E66;&apos;</span>});
store.dispatch({<span class="hljs-attr">type</span>: <span class="hljs-string">&apos;add_todos&apos;</span>, <span class="hljs-attr">items</span>: [<span class="hljs-string">&apos;&#x9605;&#x8BFB;&apos;</span>, <span class="hljs-string">&apos;&#x7761;&#x89C9;&apos;</span>]});
<span class="hljs-built_in">console</span>.log(<span class="hljs-string">&apos;state is: &apos;</span> + store.getState());  <span class="hljs-comment">// state is: &#x8BFB;&#x4E66;,&#x9605;&#x8BFB;,&#x7761;&#x89C9;</span>

actions.addTodo(<span class="hljs-string">&apos;&#x770B;&#x7535;&#x5F71;&apos;</span>);
<span class="hljs-built_in">console</span>.log(<span class="hljs-string">&apos;state is: &apos;</span> + store.getState());  <span class="hljs-comment">// state is: &#x8BFB;&#x4E66;,&#x9605;&#x8BFB;,&#x7761;&#x89C9;,&#x770B;&#x7535;&#x5F71;</span>

actions.addTodos([<span class="hljs-string">&apos;&#x5237;&#x7259;&apos;</span>, <span class="hljs-string">&apos;&#x6D17;&#x6FA1;&apos;</span>]);
<span class="hljs-built_in">console</span>.log(<span class="hljs-string">&apos;state is: &apos;</span> + store.getState());  <span class="hljs-comment">// state is: &#x8BFB;&#x4E66;,&#x9605;&#x8BFB;,&#x7761;&#x89C9;,&#x770B;&#x7535;&#x5F71;,&#x5237;&#x7259;,&#x6D17;&#x6FA1;</span>
</code></pre>
<ul>
<li>&#x76F4;&#x63A5;&#x770B;&#x4EE3;&#x7801;</li>
</ul>
<pre><code class="lang-javascript"><span class="hljs-keyword">import</span> mapValues <span class="hljs-keyword">from</span> <span class="hljs-string">&apos;../utils/mapValues&apos;</span>;

<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">bindActionCreator</span>(<span class="hljs-params">actionCreator, dispatch</span>) </span>{
  <span class="hljs-keyword">return</span> <span class="hljs-function">(<span class="hljs-params">...args</span>) =&gt;</span> dispatch(actionCreator(...args));
}

<span class="hljs-comment">/**
 * Turns an object whose values are action creators, into an object with the
 * same keys, but with every function wrapped into a `dispatch` call so they
 * may be invoked directly. This is just a convenience method, as you can call
 * `store.dispatch(MyActionCreators.doSomething())` yourself just fine.
 *
 * For convenience, you can also pass a single function as the first argument,
 * and get a function in return.
 *
 * @param {Function|Object} actionCreators An object whose values are action
 * creator functions. One handy way to obtain it is to use ES6 `import * as`
 * syntax. You may also pass a single function.
 *
 * @param {Function} dispatch The `dispatch` function available on your Redux
 * store.
 *
 * @returns {Function|Object} The object mimicking the original object, but with
 * every action creator wrapped into the `dispatch` call. If you passed a
 * function as `actionCreators`, the return value will also be a single
 * function.
 */</span>
<span class="hljs-comment">// &#x5047;&#x8BBE; actionCreators === {addTodo: addTodo, removeTodo: removeTodo}</span>
<span class="hljs-comment">// &#x7B80;&#x5355;&#x7684;&#x6765;&#x8BF4; bindActionCreators(actionCreators, dispatch)</span>
<span class="hljs-comment">// &#x6700;&#x540E;&#x8FD4;&#x56DE;&#x7684;&#x662F;:</span>
<span class="hljs-comment">// {</span>
<span class="hljs-comment">//   addTodo: function(text){</span>
<span class="hljs-comment">//      dispatch( actionCreators.addTodo(text) );</span>
<span class="hljs-comment">//   },</span>
<span class="hljs-comment">//   removeTodo: function(text){</span>
<span class="hljs-comment">//      dispatch( actionCreators.removeTodo(text) );</span>
<span class="hljs-comment">//   }</span>
<span class="hljs-comment">// }</span>
<span class="hljs-comment">//</span>
<span class="hljs-comment">//  &#x6216;&#x8005;&#x8BF4; actionCreators === addTodo (addTodo &#x4E3A; actionCreator)</span>
<span class="hljs-comment">//  &#x6700;&#x540E;&#x8FD4;&#x56DE;&#x7684;&#x662F;</span>
<span class="hljs-comment">//  function() {</span>
<span class="hljs-comment">//     dispatch(actionCreators());</span>
<span class="hljs-comment">//  }</span>
<span class="hljs-keyword">export</span> <span class="hljs-keyword">default</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">bindActionCreators</span>(<span class="hljs-params">actionCreators, dispatch</span>) </span>{
  <span class="hljs-keyword">if</span> (<span class="hljs-keyword">typeof</span> actionCreators === <span class="hljs-string">&apos;function&apos;</span>) {
    <span class="hljs-keyword">return</span> bindActionCreator(actionCreators, dispatch);
  }

  <span class="hljs-keyword">if</span> (<span class="hljs-keyword">typeof</span> actionCreators !== <span class="hljs-string">&apos;object&apos;</span> || actionCreators === <span class="hljs-literal">null</span> || actionCreators === <span class="hljs-literal">undefined</span>) {  <span class="hljs-comment">// eslint-disable-line no-eq-null</span>
    <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> <span class="hljs-built_in">Error</span>(
      <span class="hljs-string">`bindActionCreators expected an object or a function, instead received <span class="hljs-subst">${actionCreators === <span class="hljs-literal">null</span> ? <span class="hljs-string">&apos;null&apos;</span> : <span class="hljs-keyword">typeof</span> actionCreators}</span>. `</span> +
      <span class="hljs-string">`Did you write &quot;import ActionCreators from&quot; instead of &quot;import * as ActionCreators from&quot;?`</span>
    );
  }

  <span class="hljs-keyword">return</span> mapValues(actionCreators, actionCreator =&gt;
    bindActionCreator(actionCreator, dispatch)
  );
}
</code></pre>
<h2 id="t4&#x4E94;&#x3001;applyMiddleware.js">&#x4E94;&#x3001;applyMiddleware.js <a href="#t4&#x4E94;&#x3001;applyMiddleware.js"> # </a></h2>
<blockquote>
<p><a href="https://github.com/reactjs/redux/blob/master/src/applyMiddleware.js">https://github.com/reactjs/redux/blob/master/src/applyMiddleware.js</a></p>
</blockquote>
<ul>
<li>&#x4E2D;&#x95F4;&#x4EF6;&#x5E94;&#x8BE5;&#x662F;<code>redux</code>&#x6E90;&#x7801;&#x91CC;&#x9762;&#x6700;&#x7ED5;&#x7684;&#x4E00;&#x90E8;&#x5206;</li>
</ul>
<p><strong>&#x4F8B;&#x5B50;&#xFF1A;redux-thunk</strong></p>
<pre><code class="lang-javascript"><span class="hljs-keyword">export</span> <span class="hljs-keyword">default</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">thunkMiddleware</span>(<span class="hljs-params">{ dispatch, getState }</span>) </span>{
  <span class="hljs-keyword">return</span> <span class="hljs-function"><span class="hljs-params">next</span> =&gt;</span> action =&gt;
    <span class="hljs-keyword">typeof</span> action === <span class="hljs-string">&apos;function&apos;</span> ?
      action(dispatch, getState) :
      next(action);
}
</code></pre>
<pre><code class="lang-javascript">
<span class="hljs-comment">//es5</span>
<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">thunkMiddleware</span>(<span class="hljs-params">store</span>) </span>{
  <span class="hljs-keyword">var</span> dispatch = store.dispatch;
  <span class="hljs-keyword">var</span> getState = store.getState;

  <span class="hljs-keyword">return</span> <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params">next</span>) </span>{
    <span class="hljs-keyword">return</span> <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params">action</span>) </span>{
      <span class="hljs-keyword">return</span> <span class="hljs-keyword">typeof</span> action === <span class="hljs-string">&apos;function&apos;</span> ? action(dispatch, getState) : next(action);
    };
  };
}
</code></pre>
<p><strong>&#x81EA;&#x5B9A;&#x4E49;&#x4E2D;&#x95F4;&#x4EF6;&#xFF1A;logger</strong></p>
<ul>
<li>&#x5148;&#x770B;<code>logger</code>&#x7684;&#x5B9E;&#x73B0;</li>
</ul>
<pre><code class="lang-javascript"><span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">middleware</span>(<span class="hljs-params">store</span>)</span>{
    <span class="hljs-keyword">return</span> <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">next</span>)</span>{
        <span class="hljs-keyword">return</span> <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">action</span>)</span>{
            <span class="hljs-keyword">return</span> next(action);
        }
    }
}
</code></pre>
<blockquote>
<p>&#x57FA;&#x672C;&#x770B;&#x51FA;&#x4E2D;&#x95F4;&#x4EF6;&#x58F0;&#x660E;&#x7684;&#x6A21;&#x7248;&#x6765;&#x4E86;&#xFF0C;&#x5C31;&#x662F;&#x4E0B;&#x9762;&#x8FD9;&#x4E2A;&#x6837;&#x5B50;&#x3002;&#x4E0B;&#x9762;&#x7ED3;&#x5408;<code>applyMiddleware</code>&#x7684;&#x8C03;&#x7528;&#xFF0C;&#x6765;&#x8BF4;&#x660E;<code>store</code>&#x3001;<code>next</code>&#x3001;<code>action</code> &#x51E0;&#x4E2A;&#x53C2;&#x6570;&#x3002;</p>
</blockquote>
<pre><code class="lang-javascript"><span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">logger</span>(<span class="hljs-params">store</span>)</span>{
    <span class="hljs-keyword">return</span> <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">next</span>)</span>{
        <span class="hljs-keyword">return</span> <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">action</span>)</span>{
            <span class="hljs-built_in">console</span>.log(<span class="hljs-string">&apos;logger: dispatching &apos;</span> + action.type);
            <span class="hljs-keyword">var</span> result = next(action);
            <span class="hljs-built_in">console</span>.log(<span class="hljs-string">&apos;logger: next state &apos;</span> + result);
            <span class="hljs-keyword">return</span> result;
        }
    }
}
</code></pre>
<p><strong>applyMiddleware&#x8C03;&#x7528;&#x4F8B;&#x5B50;</strong></p>
<ul>
<li><code>applyMiddleware</code> &#x7684;&#x8C03;&#x7528;&#x65B9;&#x5F0F;&#x4E3A; <code>applyMiddleware(...middlewares)(react.createStore)</code>&#x3002;&#x5176;&#x5B9E;&#x8FD9;&#x91CC;&#x76F4;&#x63A5;&#x5148;&#x521B;&#x5EFA; <code>store</code>&#xFF0C;&#x7136;&#x540E;<code>applyMiddleware(...middlewares)(store)</code> &#x4E5F;&#x5F88;&#x5BB9;&#x6613;&#x5B9E;&#x73B0;&#x76F8;&#x540C;&#x7684;&#x6548;&#x679C;&#xFF0C;&#x4E0D;&#x8FC7;&#x4F5C;&#x8005;&#x662F;&#x6545;&#x610F;&#x8FD9;&#x6837;&#x8BBE;&#x8BA1;&#x7684;&#xFF0C;&#x4E3A;&#x4E86;&#x907F;&#x514D;&#x5728;&#x540C;&#x4E00;&#x4E2A;store&#x4E0A;&#x591A;&#x6B21;&#x5E94;&#x7528;&#x540C;&#x4E00;&#x4E2A;<code>middlerware</code></li>
<li>&#x4E2D;&#x95F4;&#x4EF6;&#x9876;&#x5C42;&#x7684;<code>store</code>&#x53C2;&#x6570;&#xFF0C;&#x5E76;&#x4E0D;&#x662F;&#x5E38;&#x89C4;&#x7684;<code>store</code>&#xFF0C;&#x867D;&#x7136;&#x5B83;&#x4E5F;&#x6709; <code>getState</code>&#x3001;<code>dispatch</code> &#x4E24;&#x4E2A;&#x65B9;&#x6CD5;</li>
</ul>
<pre><code class="lang-javascript"><span class="hljs-comment">// &#x4E0A;&#x9762;&#x7684;store&#x53C2;&#x6570;&#xFF0C;&#x5176;&#x5B9E;&#x5C31;&#x662F;&#x8FD9;&#x4E2A;&#x5BF9;&#x8C61;</span>
<span class="hljs-comment">// &#x5176;&#x4E2D;&#xFF0C;store &#x4E3A;&#x5185;&#x90E8;&#x7684;store&#xFF0C;&#x6211;&#x4EEC;&#x5728;&#x5916;&#x9762; storeWithMiddleWare.dipatch&#x7684;&#x65F6;&#x5019;&#xFF0C;&#x5185;&#x90E8;&#x5B9E;&#x73B0;&#x662F;&#x8F6C;&#x6210; store.dispatch</span>
<span class="hljs-comment">// &#x6B64;&#x5916;&#xFF0C;&#x53EF;&#x4EE5;&#x770B;&#x5230; middlewareAPI.dispatch &#x65B9;&#x6CD5;&#xFF0C;&#x662F;&#x6700;&#x7EC8;&#x5C01;&#x88C5;&#x540E;&#x7684;dispatch&#xFF08;&#x5343;&#x4E07;&#x6CE8;&#x610F;&#xFF0C;&#x5982;&#x679C;&#x5728;&#x4E2D;&#x95F4;&#x4EF6;&#x5185;&#x90E8; &#x8C03;&#x7528; store.dispatch&#xFF0C;&#x53EF;&#x80FD;&#x5BFC;&#x81F4;&#x6B7B;&#x5FAA;&#x73AF; &#xFF09;</span>
<span class="hljs-keyword">var</span> middlewareAPI = {
  <span class="hljs-attr">getState</span>: store.getState,
  <span class="hljs-comment">// &#x6700;&#x540E;&#x9762;, dispatch &#x88AB;&#x8986;&#x76D6;, &#x53D8;&#x6210;&#x5305;&#x88C5;&#x540E;&#x7684; dispatch &#x65B9;&#x6CD5;</span>
  dispatch: <span class="hljs-function">(<span class="hljs-params">action</span>) =&gt;</span> dispatch(action)
};
</code></pre>
<ul>
<li>&#x7B2C;&#x4E8C;&#x5C42;&#x7684;next&#x51FD;&#x6570;&#xFF0C;&#x5176;&#x5B9E;&#x662F;&#x4E00;&#x4E2A;&#x201C;dispatch&#x201D;&#x65B9;&#x6CD5;</li>
<li>storeWithMiddleWare.dispatch(action) &#x7684;&#x65F6;&#x5019;&#xFF0C;&#x4F1A;&#x987A;&#x5E8F;&#x8FDB;&#x5165;&#x5404;&#x4E2A;&#x4E2D;&#x95F4;&#x4EF6;&#xFF08;&#x6309;&#x7167;&#x5B9A;&#x4E49;&#x65F6;&#x7684;&#x987A;&#x5E8F;&#xFF09;&#x3002;&#x4ECE;&#x5F53;&#x524D;&#x7684;&#x4F8B;&#x5B50;&#x6765;&#x770B;&#xFF0C;&#x5927;&#x7EA6;&#x5982;&#x4E0B;&#xFF0C;&#x5176;&#x5B9E;&#x5C31;&#x662F;&#x67EF;&#x91CC;&#x5316;&#x5566;</li>
</ul>
<pre><code class="lang-javascript">storeWithMiddleWare.dispatch(action) --&gt; logger(store)(next)(action) --&gt; timer(store)(next)(action) --&gt; store.dispatch(action)
</code></pre>
<p><strong>&#x5B8C;&#x6574;&#x7684;&#x793A;&#x4F8B;&#x4EE3;&#x7801;</strong></p>
<pre><code class="lang-javascript"><span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">reducer</span>(<span class="hljs-params">state, action</span>)</span>{
    <span class="hljs-keyword">if</span>(<span class="hljs-keyword">typeof</span> state===<span class="hljs-string">&apos;undefined&apos;</span>) state = [];

    <span class="hljs-keyword">switch</span>(action.type){
        <span class="hljs-keyword">case</span> <span class="hljs-string">&apos;add_todo&apos;</span>:
            <span class="hljs-keyword">return</span> state.concat(action.text);
        <span class="hljs-keyword">default</span>: 
            <span class="hljs-keyword">return</span> state;
    }
}

<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">addTodo</span>(<span class="hljs-params">text</span>)</span>{
    <span class="hljs-keyword">return</span> {
        <span class="hljs-attr">type</span>: <span class="hljs-string">&apos;add_todo&apos;</span>,
        <span class="hljs-attr">text</span>: text
    };
}

<span class="hljs-comment">// &#x8FD9;&#x91CC;&#x7684; store&#xFF0C;&#x5E76;&#x4E0D;&#x662F; redux.createStore(reducer, initialState) &#x51FA;&#x6765;&#x7684; store</span>
<span class="hljs-comment">// &#x800C;&#x662F; {getState: store.getState, dispatch: function() { store.dispatch(action); }}</span>
<span class="hljs-comment">// </span>
<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">logger</span>(<span class="hljs-params">store</span>)</span>{    
    <span class="hljs-comment">//     </span>
    <span class="hljs-keyword">return</span> <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">next</span>)</span>{
        <span class="hljs-keyword">return</span> <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">action</span>)</span>{
            <span class="hljs-built_in">console</span>.log(<span class="hljs-string">&apos;logger: dispatching &apos;</span> + action.type);
            <span class="hljs-keyword">var</span> result = next(action);
            <span class="hljs-built_in">console</span>.log(<span class="hljs-string">&apos;logger: next state &apos;</span> + result);
            <span class="hljs-keyword">return</span> result;
        }
    }
}

<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">timer</span>(<span class="hljs-params">store</span>)</span>{
    <span class="hljs-keyword">return</span> <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">next</span>)</span>{
        <span class="hljs-keyword">return</span> <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">action</span>)</span>{
            <span class="hljs-built_in">console</span>.log(<span class="hljs-string">&apos;timer: dispatching &apos;</span> + action.type);
            <span class="hljs-keyword">var</span> result = next(action);
            <span class="hljs-built_in">console</span>.log(<span class="hljs-string">&apos;timer: next state &apos;</span> + result);
            <span class="hljs-keyword">return</span> result;
        }
    }
}

<span class="hljs-keyword">var</span> createStoreWidthMiddleware = redux.applyMiddleware(
    logger, 
    timer
    )(redux.createStore);

<span class="hljs-keyword">var</span> storeWithMiddleWare = createStoreWidthMiddleware(reducer);
storeWithMiddleWare.subscribe(<span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>)</span>{
    <span class="hljs-built_in">console</span>.log(<span class="hljs-string">&apos;subscribe: state is : &apos;</span> + storeWithMiddleWare.getState());
});
<span class="hljs-built_in">console</span>.log( storeWithMiddleWare.dispatch(addTodo(<span class="hljs-string">&apos;reading&apos;</span>)) );
</code></pre>
<p><strong>&#x6E90;&#x7801;&#x89E3;&#x6790;</strong></p>
<p><code>`</code>javascript
import compose from &apos;./compose&apos;;</p>
<p>/**</p>
<ul>
<li>Creates a store enhancer that applies middleware to the dispatch method</li>
<li>of the Redux store. This is handy for a variety of tasks, such as expressing</li>
<li>asynchronous actions in a concise manner, or logging every action payload.
*</li>
<li>See <code>redux-thunk</code> package as an example of the Redux middleware.
*</li>
<li>Because middleware is potentially asynchronous, this should be the first</li>
<li>store enhancer in the composition chain.
*</li>
<li>Note that each middleware will be given the <code>dispatch</code> and <code>getState</code> functions</li>
<li>as named arguments.
*</li>
<li>@param {...Function} middlewares The middleware chain to be applied.</li>
<li><p>@returns {Function} A store enhancer applying the middleware.
<em>/
/</em>
&#x4ECE;&#x8C03;&#x7528;&#x65B9;&#x6CD5; applyMiddleware(...middlewares)(Redux.createStore) &#x53EF;&#x4EE5;&#x770B;&#x51FA;
next &#x53C2;&#x6570;&#x5B9E;&#x9645;&#x4E0A;&#x662F; Redux.createStore. &#x800C; Redux.createStore &#x7684;&#x8C03;&#x7528;&#x65B9;&#x5F0F;&#x4E3A; Redux.createStore(reducer, initialState)
&#x6240;&#x4EE5; applyMiddleware(...middlewares)</p>
<ol>
<li>&#x53C2;&#x6570;: Redux.createStore</li>
<li>&#x8FD4;&#x56DE;&#x503C;:&#x4E00;&#x4E2A;function, &#x8DDF; Redux.createStore &#x63A5;&#x53D7;&#x7684;&#x53C2;&#x6570;&#x4E00;&#x6837;</li>
</ol>
<p>*/
export default function applyMiddleware(...middlewares) {
return (next)</p>
</li>
</ul>

        <div class="copyright">Powered by <a href="https://github.com/jaywcjlove/idoc" target="_blank">idoc</a>. Dependence <a href="https://nodejs.org">Node.js</a> run.</div>
    </div>
    
</div>


</body>
</html>
